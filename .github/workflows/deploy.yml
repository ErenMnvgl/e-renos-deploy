name: Deploy to Server

on:
  push:
    branches:
      - master  # EÄŸer ana dalÄ±n "main" ise "master" yerine "main" yaz.

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Kodu Depodan Ã‡ek
        uses: actions/checkout@v4

      - name: ğŸš€ Sunucuya BaÄŸlan ve Deploy Et
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: 158.220.109.38  # Sunucunun IP adresini yaz
          username: eren  # Sunucudaki kullanÄ±cÄ± adÄ±n
          key: ${{ secrets.SSH_PRIVATE_KEY }}
          script: |
            cd /var/www/html
            git pull origin master  # EÄŸer "main" branch kullanÄ±yorsan master yerine main yaz
            composer install --no-dev --prefer-dist  # PHP projesi ise gerekli baÄŸÄ±mlÄ±lÄ±klarÄ± yÃ¼kler
            npm install && npm run build  # EÄŸer Node.js projesi ise
            php artisan migrate --force  # Laravel gibi frameworklerde database migration
            sudo systemctl restart nginx  # Nginx restart ile yeni kodlarÄ± aktifleÅŸtir
            echo "ğŸš€ Deployment BaÅŸarÄ±lÄ±!"
